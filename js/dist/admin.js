(()=>{var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var s in a)e.o(a,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:a[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};(()=>{"use strict";const t=flarum.core.compat["admin/app"];var a=e.n(t);function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t)}const n=flarum.core.compat["admin/components/ExtensionPage"];var i=e.n(n);const o=flarum.core.compat["common/components/LoadingIndicator"];var l=e.n(o);const d=flarum.core.compat["common/Component"];var c=e.n(d),u=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var a=t.prototype;return a.view=function(){var e=this.attrs.stats||{total:0,positive:0,neutral:0,negative:0};return m("div",{className:"TraderFeedbackStats"},this.card({icon:"fas fa-exchange-alt",value:e.total,label:"Total Feedbacks",type:"total"}),this.card({icon:"fas fa-thumbs-up",value:e.positive,label:"Positive",percentage:e.total>0?Math.round(e.positive/e.total*100):0,type:"positive"}),this.card({icon:"fas fa-minus-circle",value:e.neutral,label:"Neutral",percentage:e.total>0?Math.round(e.neutral/e.total*100):0,type:"neutral"}),this.card({icon:"fas fa-thumbs-down",value:e.negative,label:"Negative",percentage:e.total>0?Math.round(e.negative/e.total*100):0,type:"negative"}))},a.card=function(e){return m("div",{className:"StatsCard StatsCard--"+e.type},m("div",{className:"StatsCard-icon"},m("i",{className:e.icon})),m("div",{className:"StatsCard-content"},m("div",{className:"StatsCard-value"},e.value),m("div",{className:"StatsCard-label"},e.label),void 0!==e.percentage&&m("div",{className:"StatsCard-percentage"},e.percentage,"%")))},t}(c());const p=flarum.core.compat["common/components/Button"];var f=e.n(p);const b=flarum.core.compat["common/helpers/avatar"];var h=e.n(b);const v=flarum.core.compat["common/helpers/humanTime"];var g=e.n(v),y=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.view=function(){var e,t,s,r,n=this.attrs,i=n.feedback,o=n.included,l=n.onApprove,d=n.onReject,c=(null==(e=i.relationships)||null==(e=e.fromUser)||null==(e=e.data)?void 0:e.id)||(null==(t=i.relationships)||null==(t=t.from)||null==(t=t.data)?void 0:t.id),u=(null==(s=i.relationships)||null==(s=s.toUser)||null==(s=s.data)?void 0:s.id)||(null==(r=i.relationships)||null==(r=r.to)||null==(r=r.data)?void 0:r.id),p=c?a().store.getById("users",c):null,b=u?a().store.getById("users",u):null;if(!p&&c){var v=null==o?void 0:o.find((function(e){return"users"===e.type&&e.id===c}));v&&(p=a().store.pushPayload({data:v}))}if(!b&&u){var y=null==o?void 0:o.find((function(e){return"users"===e.type&&e.id===u}));y&&(b=a().store.pushPayload({data:y}))}var k="positive"===i.attributes.type?"Badge--success":"negative"===i.attributes.type?"Badge--danger":"Badge--warning",N="positive"===i.attributes.type?"thumbs-up":"negative"===i.attributes.type?"thumbs-down":"minus",F="buyer"===i.attributes.role?"shopping-cart":"seller"===i.attributes.role?"store":"exchange-alt";return m("div",{className:"FeedbackCard FeedbackCard--"+i.attributes.type},m("div",{className:"FeedbackCard-header"},m("div",{className:"FeedbackCard-users"},m("div",{className:"FeedbackCard-user"},p&&h()(p),m("strong",null,p?p.displayName():"User #"+c)),m("i",{className:"fas fa-arrow-right FeedbackCard-arrow"}),m("div",{className:"FeedbackCard-user"},b&&h()(b),m("strong",null,b?b.displayName():"User #"+u))),m("div",{className:"FeedbackCard-meta"},m("span",{className:"Badge "+k},m("i",{className:"fas fa-"+N})),m("span",{className:"FeedbackCard-roleBadge"},m("i",{className:"fas fa-"+F}),m("span",null,i.attributes.role)),(i.attributes.created_at||i.attributes.updated_at)&&m("span",{className:"FeedbackCard-dateBadge"},m("i",{className:"far fa-clock"}),m("span",null,g()(new Date(i.attributes.created_at||i.attributes.updated_at)))))),i.attributes.comment&&m("div",{className:"FeedbackCard-comment"},m("p",null,i.attributes.comment)),i.attributes.discussion_id&&m("a",{href:a().route("discussion",{id:i.attributes.discussion_id}),className:"FeedbackCard-discussion",target:"_blank"},m("i",{className:"fas fa-comments"}),"View Discussion"),m("div",{className:"FeedbackCard-actions"},m(f(),{className:"Button Button--primary",icon:"fas fa-check",onclick:function(){return l(i)}},"Approve"),m(f(),{className:"Button",icon:"fas fa-times",onclick:function(){return d(i)}},"Reject")))},t}(c()),k=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.view=function(){var e,t,s,r,n,i,o,l=this.attrs,d=l.report,c=l.included,u=l.onDismiss,p=l.onDelete,b=(null==(e=d.relationships)||null==(e=e.reporter)||null==(e=e.data)?void 0:e.id)||(null==(t=d.relationships)||null==(t=t.user)||null==(t=t.data)?void 0:t.id),v=b?a().store.getById("users",b):null;if(!v&&b){var y=null==c?void 0:c.find((function(e){return"users"===e.type&&e.id===b}));y&&(v=a().store.pushPayload({data:y}))}var k=null==(s=d.relationships)||null==(s=s.feedback)||null==(s=s.data)?void 0:s.id,N=null==c?void 0:c.find((function(e){return"trader-feedbacks"===e.type&&e.id===k})),F=(null==N||null==(r=N.relationships)||null==(r=r.fromUser)||null==(r=r.data)?void 0:r.id)||(null==N||null==(n=N.relationships)||null==(n=n.from)||null==(n=n.data)?void 0:n.id),S=(null==N||null==(i=N.relationships)||null==(i=i.toUser)||null==(i=i.data)?void 0:i.id)||(null==N||null==(o=N.relationships)||null==(o=o.to)||null==(o=o.data)?void 0:o.id),_=F?a().store.getById("users",F):null,C=S?a().store.getById("users",S):null;if(!_&&F){var w=null==c?void 0:c.find((function(e){return"users"===e.type&&e.id===F}));w&&(_=a().store.pushPayload({data:w}))}if(!C&&S){var R=null==c?void 0:c.find((function(e){return"users"===e.type&&e.id===S}));R&&(C=a().store.pushPayload({data:R}))}var B="positive"===(null==N?void 0:N.attributes.type)?"Badge--success":"negative"===(null==N?void 0:N.attributes.type)?"Badge--danger":"Badge--warning",P="positive"===(null==N?void 0:N.attributes.type)?"thumbs-up":"negative"===(null==N?void 0:N.attributes.type)?"thumbs-down":"minus";return m("div",{className:"ReportCard"},m("div",{className:"ReportCard-header"},m("div",{className:"ReportCard-reporter"},v&&h()(v),m("strong",null,v?v.displayName():b?"User #"+b:"Unknown")),(d.attributes.created_at||d.attributes.updated_at)&&m("span",{className:"ReportCard-dateBadge"},m("i",{className:"far fa-clock"}),m("span",null,g()(new Date(d.attributes.created_at||d.attributes.updated_at))))),d.attributes.reason&&m("div",{className:"ReportCard-reason"},m("strong",null,"Reason:"),m("p",null,d.attributes.reason)),N&&m("div",{className:"ReportCard-feedback"},m("div",{className:"ReportCard-feedbackHeader"},m("div",{className:"ReportCard-feedbackHeader-left"},m("span",null,"Reported Feedback"),m("span",{className:"Badge "+B},m("i",{className:"fas fa-"+P})))),m("div",{className:"ReportCard-feedbackUsers"},_&&h()(_),m("span",null,_?_.displayName():"User #"+F),m("i",{className:"fas fa-arrow-right"}),C&&h()(C),m("span",null,C?C.displayName():"User #"+S)),N.attributes.comment&&m("div",{className:"ReportCard-feedbackComment"},m("p",null,N.attributes.comment))),m("div",{className:"ReportCard-actions"},m(f(),{className:"Button Button--primary",icon:"fas fa-check",onclick:function(){return u(d)}},"Dismiss Report"),m(f(),{className:"Button",icon:"fas fa-trash",onclick:function(){return p(d)}},"Delete Feedback")))},t}(c()),N=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.view=function(){var e=this.attrs,t=e.buildSettingComponent,s=e.submitButton;return m("div",{className:"TraderFeedbackSettings"},m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-cog"}),"General Settings"),m("div",{className:"SettingsSection-content"},m("div",{className:"Form-group"},t({type:"boolean",setting:"huseyinfiliz.traderfeedback.requireApproval",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.require_approval_label")})),m("div",{className:"Form-group"},t({type:"boolean",setting:"huseyinfiliz.traderfeedback.allowNegative",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.allow_negative_label")})))),m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-comments"}),"Discussion Settings"),m("div",{className:"SettingsSection-content"},m("div",{className:"Form-group"},t({type:"boolean",setting:"huseyinfiliz.traderfeedback.requireDiscussion",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.require_discussion_label"),help:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.require_discussion_help")})),m("div",{className:"Form-group"},t({type:"boolean",setting:"huseyinfiliz.traderfeedback.onePerDiscussion",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.one_per_discussion_label"),help:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.one_per_discussion_help")})))),m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-comment-dots"}),"Comment Settings"),m("div",{className:"SettingsSection-content"},m("div",{className:"Form-group"},t({type:"number",setting:"huseyinfiliz.traderfeedback.minLength",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.min_length_label"),placeholder:"10",min:1})),m("div",{className:"Form-group"},t({type:"number",setting:"huseyinfiliz.traderfeedback.maxLength",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.max_length_label"),placeholder:"1000",min:1})))),m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-user-check"}),"User Requirements"),m("div",{className:"SettingsSection-content"},m("div",{className:"Form-group"},t({type:"number",setting:"huseyinfiliz.traderfeedback.minDays",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.min_days_label"),help:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.min_days_help"),placeholder:"0",min:0})),m("div",{className:"Form-group"},t({type:"number",setting:"huseyinfiliz.traderfeedback.minPosts",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.min_posts_label"),help:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.min_posts_help"),placeholder:"0",min:0})))),m("div",{className:"Form-group"},s()))},t}(c()),F=function(e){function t(){for(var t,a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))||this).activeTab="settings",t.loading=!1,t.reports=[],t.pendingFeedbacks=[],t.stats=null,t.included=[],t}r(t,e);var s=t.prototype;return s.oninit=function(t){e.prototype.oninit.call(this,t),this.loadStats()},s.content=function(){return m("div",{className:"TraderFeedbackPage"},m(u,{stats:this.stats}),this.tabs(),m("div",{className:"TraderFeedbackPage-content"},this.activeTabContent()))},s.tabs=function(){var e=this;return m("div",{className:"TraderFeedbackTabs"},m("button",{className:"TabButton"+("settings"===this.activeTab?" active":""),onclick:function(){e.activeTab="settings"}},m("i",{className:"fas fa-cog"}),m("span",null,"Settings")),m("button",{className:"TabButton"+("approvals"===this.activeTab?" active":""),onclick:function(){e.activeTab="approvals",0===e.pendingFeedbacks.length&&e.loadPendingFeedbacks()}},m("i",{className:"fas fa-check-circle"}),m("span",null,"Pending Approvals"),this.pendingFeedbacks.length>0&&m("span",{className:"TabButton-badge"},this.pendingFeedbacks.length)),m("button",{className:"TabButton"+("reports"===this.activeTab?" active":""),onclick:function(){e.activeTab="reports",0===e.reports.length&&e.loadReports()}},m("i",{className:"fas fa-flag"}),m("span",null,"Reports"),this.reports.length>0&&m("span",{className:"TabButton-badge TabButton-badge--warning"},this.reports.length)))},s.activeTabContent=function(){var e=this;switch(this.activeTab){case"settings":return m(N,{buildSettingComponent:this.buildSettingComponent.bind(this),submitButton:this.submitButton.bind(this),onSave:function(){return e.saveSettings()}});case"approvals":return this.approvalsContent();case"reports":return this.reportsContent();default:return null}},s.approvalsContent=function(){var e=this;return this.loading?m(l(),null):0===this.pendingFeedbacks.length?m("div",{className:"EmptyState"},m("div",{className:"EmptyState-icon"},m("i",{className:"fas fa-check-circle"})),m("h3",null,"No Pending Approvals"),m("p",null,"All feedbacks have been reviewed")):m("div",{className:"FeedbackList"},this.pendingFeedbacks.map((function(t){return m(y,{key:t.id,feedback:t,included:e.included,onApprove:function(t){return e.approveFeedback(t)},onReject:function(t){return e.rejectFeedback(t)}})})))},s.reportsContent=function(){var e=this;return this.loading?m(l(),null):0===this.reports.length?m("div",{className:"EmptyState"},m("div",{className:"EmptyState-icon"},m("i",{className:"fas fa-shield-alt"})),m("h3",null,"No Active Reports"),m("p",null,"Your community is safe and clean")):m("div",{className:"ReportList"},this.reports.map((function(t){return m(k,{key:t.id,report:t,included:e.included,onDismiss:function(t){return e.dismissReport(t)},onDelete:function(t){return e.deleteReportedFeedback(t)}})})))},s.loadStats=function(){var e=this;a().request({method:"GET",url:a().forum.attribute("apiUrl")+"/trader/stats/summary"}).then((function(t){var a;a=t.data&&Array.isArray(t.data)&&t.data[0]?t.data[0].attributes:t.data&&t.data.attributes?t.data.attributes:t.attributes?t.attributes:void 0!==t.total?t:{total:0,positive:0,neutral:0,negative:0},e.stats={total:a.total||0,positive:a.positive||0,neutral:a.neutral||0,negative:a.negative||0},console.log("✅ Stats loaded:",e.stats),m.redraw()})).catch((function(t){console.error("❌ Stats load error:",t),e.stats={total:0,positive:0,neutral:0,negative:0},m.redraw()}))},s.loadPendingFeedbacks=function(){var e=this;this.loading=!0,this.included=[],m.redraw(),a().request({method:"GET",url:a().forum.attribute("apiUrl")+"/trader/feedback/pending"}).then((function(t){e.pendingFeedbacks=t.data||[],e.included=t.included||[],e.processIncluded(t),e.loading=!1,console.log("✅ Pending feedbacks loaded:",e.pendingFeedbacks.length),m.redraw()})).catch((function(t){console.error("❌ Pending feedbacks error:",t),e.loading=!1,m.redraw()}))},s.loadReports=function(){var e=this;this.loading=!0,this.included=[],m.redraw(),a().request({method:"GET",url:a().forum.attribute("apiUrl")+"/trader/reports"}).then((function(t){e.reports=t.data||[],e.included=t.included||[],e.processIncluded(t),e.loading=!1,console.log("✅ Reports loaded:",e.reports.length),m.redraw()})).catch((function(t){console.error("❌ Reports error:",t),a().alerts.show({type:"error"},"Failed to load reports"),e.loading=!1,m.redraw()}))},s.processIncluded=function(e){e.included&&e.included.forEach((function(e){if("users"===e.type&&e.id&&!a().store.getById("users",e.id)){var t=a().store.createRecord("users");t.pushAttributes(e.attributes||{}),t.id(e.id)}}))},s.approveFeedback=function(e){var t=this;confirm("Approve this feedback?")&&a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/trader/feedback/"+e.id+"/approve"}).then((function(){a().alerts.show({type:"success"},"Feedback approved"),t.loadPendingFeedbacks(),t.loadStats()})).catch((function(e){console.error("Approve error:",e),a().alerts.show({type:"error"},"Failed to approve feedback")}))},s.rejectFeedback=function(e){var t=this;confirm("Reject this feedback?")&&a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/trader/feedback/"+e.id+"/reject"}).then((function(){a().alerts.show({type:"success"},"Feedback rejected"),t.loadPendingFeedbacks(),t.loadStats()})).catch((function(e){console.error("Reject error:",e),a().alerts.show({type:"error"},"Failed to reject feedback")}))},s.dismissReport=function(e){var t=this;confirm("Dismiss this report?")&&a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/trader/reports/"+e.id+"/dismiss"}).then((function(){a().alerts.show({type:"success"},"Report dismissed"),t.loadReports()})).catch((function(e){console.error("Dismiss error:",e),a().alerts.show({type:"error"},"Failed to dismiss report")}))},s.deleteReportedFeedback=function(e){var t=this;confirm("Delete the reported feedback? This action cannot be undone.")&&a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/trader/reports/"+e.id+"/reject"}).then((function(){a().alerts.show({type:"success"},"Feedback deleted"),t.loadReports(),t.loadStats()})).catch((function(e){console.error("Delete error:",e),a().alerts.show({type:"error"},"Failed to delete feedback")}))},s.saveSettings=function(){var e=this;this.loading=!0,this.settings().then((function(){e.loading=!1,a().alerts.show({type:"success"},"Settings saved")})).catch((function(){e.loading=!1,a().alerts.show({type:"error"},"Failed to save settings")}))},t}(i());a().initializers.add("huseyinfiliz-traderfeedback",(function(){a().extensionData.for("huseyinfiliz-traderfeedback").registerPage(F).registerPermission({icon:"fas fa-comment",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.give_feedback"),permission:"huseyinfiliz-traderfeedback.give"},"reply",!0).registerPermission({icon:"fas fa-flag",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.report_feedback"),permission:"huseyinfiliz-traderfeedback.report"},"reply",!0).registerPermission({icon:"fas fa-trash",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.delete_feedback"),permission:"huseyinfiliz-traderfeedback.delete"},"moderate").registerPermission({icon:"fas fa-shield-alt",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.moderate_feedback"),permission:"huseyinfiliz-traderfeedback.moderate"},"moderate")}))})(),module.exports={}})();
//# sourceMappingURL=admin.js.map