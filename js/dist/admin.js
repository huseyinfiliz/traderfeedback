(()=>{var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};(()=>{"use strict";const t=flarum.core.compat["admin/app"];var a=e.n(t);function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}const n=flarum.core.compat["admin/components/ExtensionPage"];var i=e.n(n);const o=flarum.core.compat["common/components/LoadingIndicator"];var c=e.n(o);const l=flarum.core.compat["common/Component"];var d=e.n(l),u=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var a=t.prototype;return a.view=function(){var e=this.attrs.stats||{total:0,positive:0,neutral:0,negative:0};return m("div",{className:"TraderFeedbackStats"},this.card({icon:"fas fa-exchange-alt",value:e.total,label:"Total Feedbacks",type:"total"}),this.card({icon:"fas fa-thumbs-up",value:e.positive,label:"Positive",percentage:e.total>0?Math.round(e.positive/e.total*100):0,type:"positive"}),this.card({icon:"fas fa-minus-circle",value:e.neutral,label:"Neutral",percentage:e.total>0?Math.round(e.neutral/e.total*100):0,type:"neutral"}),this.card({icon:"fas fa-thumbs-down",value:e.negative,label:"Negative",percentage:e.total>0?Math.round(e.negative/e.total*100):0,type:"negative"}))},a.card=function(e){return m("div",{className:"StatsCard StatsCard--"+e.type},m("div",{className:"StatsCard-icon"},m("i",{className:e.icon})),m("div",{className:"StatsCard-content"},m("div",{className:"StatsCard-value"},e.value),m("div",{className:"StatsCard-label"},e.label),void 0!==e.percentage&&m("div",{className:"StatsCard-percentage"},e.percentage,"%")))},t}(d()),p=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var a=t.prototype;return a.view=function(){var e=this.attrs.stats||{total:0,positive:0,neutral:0,negative:0};return m("div",{className:"TraderFeedbackStats"},this.card({icon:"fas fa-exchange-alt",value:e.total,label:"Total Feedbacks",type:"total"}),this.card({icon:"fas fa-thumbs-up",value:e.positive,label:"Positive",percentage:e.total>0?Math.round(e.positive/e.total*100):0,type:"positive"}),this.card({icon:"fas fa-minus-circle",value:e.neutral,label:"Neutral",percentage:e.total>0?Math.round(e.neutral/e.total*100):0,type:"neutral"}),this.card({icon:"fas fa-thumbs-down",value:e.negative,label:"Negative",percentage:e.total>0?Math.round(e.negative/e.total*100):0,type:"negative"}))},a.card=function(e){return m("div",{className:"StatsCard StatsCard--"+e.type},m("div",{className:"StatsCard-icon"},m("i",{className:e.icon})),m("div",{className:"StatsCard-content"},m("div",{className:"StatsCard-value"},e.value),m("div",{className:"StatsCard-label"},e.label),void 0!==e.percentage&&m("div",{className:"StatsCard-percentage"},e.percentage,"%")))},t}(d()),v=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var a=t.prototype;return a.view=function(){var e=this.attrs.stats||{total:0,positive:0,neutral:0,negative:0};return m("div",{className:"TraderFeedbackStats"},this.card({icon:"fas fa-exchange-alt",value:e.total,label:"Total Feedbacks",type:"total"}),this.card({icon:"fas fa-thumbs-up",value:e.positive,label:"Positive",percentage:e.total>0?Math.round(e.positive/e.total*100):0,type:"positive"}),this.card({icon:"fas fa-minus-circle",value:e.neutral,label:"Neutral",percentage:e.total>0?Math.round(e.neutral/e.total*100):0,type:"neutral"}),this.card({icon:"fas fa-thumbs-down",value:e.negative,label:"Negative",percentage:e.total>0?Math.round(e.negative/e.total*100):0,type:"negative"}))},a.card=function(e){return m("div",{className:"StatsCard StatsCard--"+e.type},m("div",{className:"StatsCard-icon"},m("i",{className:e.icon})),m("div",{className:"StatsCard-content"},m("div",{className:"StatsCard-value"},e.value),m("div",{className:"StatsCard-label"},e.label),void 0!==e.percentage&&m("div",{className:"StatsCard-percentage"},e.percentage,"%")))},t}(d()),f=function(e){function t(){return e.apply(this,arguments)||this}s(t,e);var a=t.prototype;return a.view=function(){var e=this.attrs.stats||{total:0,positive:0,neutral:0,negative:0};return m("div",{className:"TraderFeedbackStats"},this.card({icon:"fas fa-exchange-alt",value:e.total,label:"Total Feedbacks",type:"total"}),this.card({icon:"fas fa-thumbs-up",value:e.positive,label:"Positive",percentage:e.total>0?Math.round(e.positive/e.total*100):0,type:"positive"}),this.card({icon:"fas fa-minus-circle",value:e.neutral,label:"Neutral",percentage:e.total>0?Math.round(e.neutral/e.total*100):0,type:"neutral"}),this.card({icon:"fas fa-thumbs-down",value:e.negative,label:"Negative",percentage:e.total>0?Math.round(e.negative/e.total*100):0,type:"negative"}))},a.card=function(e){return m("div",{className:"StatsCard StatsCard--"+e.type},m("div",{className:"StatsCard-icon"},m("i",{className:e.icon})),m("div",{className:"StatsCard-content"},m("div",{className:"StatsCard-value"},e.value),m("div",{className:"StatsCard-label"},e.label),void 0!==e.percentage&&m("div",{className:"StatsCard-percentage"},e.percentage,"%")))},t}(d()),h=function(e){function t(){for(var t,a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))||this).activeTab="settings",t.loading=!1,t.reports=[],t.pendingFeedbacks=[],t.stats=null,t.included=[],t}s(t,e);var r=t.prototype;return r.oninit=function(t){e.prototype.oninit.call(this,t),this.loadStats()},r.content=function(){return m("div",{className:"TraderFeedbackPage"},m(u,{stats:this.stats}),this.tabs(),m("div",{className:"TraderFeedbackPage-content"},this.activeTabContent()))},r.tabs=function(){var e=this;return m("div",{className:"TraderFeedbackTabs"},m("button",{className:"TabButton"+("settings"===this.activeTab?" active":""),onclick:function(){e.activeTab="settings"}},m("i",{className:"fas fa-cog"}),m("span",null,"Settings")),m("button",{className:"TabButton"+("approvals"===this.activeTab?" active":""),onclick:function(){e.activeTab="approvals",0===e.pendingFeedbacks.length&&e.loadPendingFeedbacks()}},m("i",{className:"fas fa-check-circle"}),m("span",null,"Pending Approvals"),this.pendingFeedbacks.length>0&&m("span",{className:"TabButton-badge"},this.pendingFeedbacks.length)),m("button",{className:"TabButton"+("reports"===this.activeTab?" active":""),onclick:function(){e.activeTab="reports",0===e.reports.length&&e.loadReports()}},m("i",{className:"fas fa-flag"}),m("span",null,"Reports"),this.reports.length>0&&m("span",{className:"TabButton-badge TabButton-badge--warning"},this.reports.length)))},r.activeTabContent=function(){var e=this;switch(this.activeTab){case"settings":return m(f,{buildSettingComponent:this.buildSettingComponent.bind(this),submitButton:this.submitButton.bind(this),onSave:function(){return e.saveSettings()}});case"approvals":return this.approvalsContent();case"reports":return this.reportsContent();default:return null}},r.approvalsContent=function(){var e=this;return this.loading?m(c(),null):0===this.pendingFeedbacks.length?m("div",{className:"EmptyState"},m("div",{className:"EmptyState-icon"},m("i",{className:"fas fa-check-circle"})),m("h3",null,"No Pending Approvals"),m("p",null,"All feedbacks have been reviewed")):m("div",{className:"FeedbackList"},this.pendingFeedbacks.map((function(t){return m(p,{key:t.id,feedback:t,included:e.included,onApprove:function(t){return e.approveFeedback(t)},onReject:function(t){return e.rejectFeedback(t)}})})))},r.reportsContent=function(){var e=this;return this.loading?m(c(),null):0===this.reports.length?m("div",{className:"EmptyState"},m("div",{className:"EmptyState-icon"},m("i",{className:"fas fa-shield-alt"})),m("h3",null,"No Active Reports"),m("p",null,"Your community is safe and clean")):m("div",{className:"ReportList"},this.reports.map((function(t){return m(v,{key:t.id,report:t,included:e.included,onDismiss:function(t){return e.dismissReport(t)},onDelete:function(t){return e.deleteReportedFeedback(t)}})})))},r.loadStats=function(){var e=this;a().request({method:"GET",url:a().forum.attribute("apiUrl")+"/trader/stats/summary"}).then((function(t){var a;a=t.data&&Array.isArray(t.data)&&t.data[0]?t.data[0].attributes:t.data&&t.data.attributes?t.data.attributes:t.attributes?t.attributes:void 0!==t.total?t:{total:0,positive:0,neutral:0,negative:0},e.stats={total:a.total||0,positive:a.positive||0,neutral:a.neutral||0,negative:a.negative||0},console.log("✅ Stats loaded:",e.stats),m.redraw()})).catch((function(t){console.error("❌ Stats load error:",t),e.stats={total:0,positive:0,neutral:0,negative:0},m.redraw()}))},r.loadPendingFeedbacks=function(){var e=this;this.loading=!0,this.included=[],m.redraw(),a().request({method:"GET",url:a().forum.attribute("apiUrl")+"/trader/feedback/pending"}).then((function(t){e.pendingFeedbacks=t.data||[],e.included=t.included||[],e.processIncluded(t),e.loading=!1,console.log("✅ Pending feedbacks loaded:",e.pendingFeedbacks.length),m.redraw()})).catch((function(t){console.error("❌ Pending feedbacks error:",t),e.loading=!1,m.redraw()}))},r.loadReports=function(){var e=this;this.loading=!0,this.included=[],m.redraw(),a().request({method:"GET",url:a().forum.attribute("apiUrl")+"/trader/reports"}).then((function(t){e.reports=t.data||[],e.included=t.included||[],e.processIncluded(t),e.loading=!1,console.log("✅ Reports loaded:",e.reports.length),m.redraw()})).catch((function(t){console.error("❌ Reports error:",t),a().alerts.show({type:"error"},"Failed to load reports"),e.loading=!1,m.redraw()}))},r.processIncluded=function(e){e.included&&e.included.forEach((function(e){if("users"===e.type&&e.id&&!a().store.getById("users",e.id)){var t=a().store.createRecord("users");t.pushAttributes(e.attributes||{}),t.id(e.id)}}))},r.approveFeedback=function(e){var t=this;confirm("Approve this feedback?")&&a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/trader/feedback/"+e.id+"/approve"}).then((function(){a().alerts.show({type:"success"},"Feedback approved"),t.loadPendingFeedbacks(),t.loadStats()})).catch((function(e){console.error("Approve error:",e),a().alerts.show({type:"error"},"Failed to approve feedback")}))},r.rejectFeedback=function(e){var t=this;confirm("Reject this feedback?")&&a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/trader/feedback/"+e.id+"/reject"}).then((function(){a().alerts.show({type:"success"},"Feedback rejected"),t.loadPendingFeedbacks(),t.loadStats()})).catch((function(e){console.error("Reject error:",e),a().alerts.show({type:"error"},"Failed to reject feedback")}))},r.dismissReport=function(e){var t=this;confirm("Dismiss this report?")&&a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/trader/reports/"+e.id+"/dismiss"}).then((function(){a().alerts.show({type:"success"},"Report dismissed"),t.loadReports()})).catch((function(e){console.error("Dismiss error:",e),a().alerts.show({type:"error"},"Failed to dismiss report")}))},r.deleteReportedFeedback=function(e){var t=this;confirm("Delete the reported feedback? This action cannot be undone.")&&a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/trader/reports/"+e.id+"/reject"}).then((function(){a().alerts.show({type:"success"},"Feedback deleted"),t.loadReports(),t.loadStats()})).catch((function(e){console.error("Delete error:",e),a().alerts.show({type:"error"},"Failed to delete feedback")}))},r.saveSettings=function(){var e=this;this.loading=!0,this.settings().then((function(){e.loading=!1,a().alerts.show({type:"success"},"Settings saved")})).catch((function(){e.loading=!1,a().alerts.show({type:"error"},"Failed to save settings")}))},t}(i());a().initializers.add("huseyinfiliz-traderfeedback",(function(){a().extensionData.for("huseyinfiliz-traderfeedback").registerPage(h).registerPermission({icon:"fas fa-comment",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.give_feedback"),permission:"huseyinfiliz-traderfeedback.give"},"reply",!0).registerPermission({icon:"fas fa-flag",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.report_feedback"),permission:"huseyinfiliz-traderfeedback.report"},"reply",!0).registerPermission({icon:"fas fa-trash",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.delete_feedback"),permission:"huseyinfiliz-traderfeedback.delete"},"moderate").registerPermission({icon:"fas fa-shield-alt",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.moderate_feedback"),permission:"huseyinfiliz-traderfeedback.moderate"},"moderate")}))})(),module.exports={}})();
//# sourceMappingURL=admin.js.map