(()=>{var e={n:a=>{var t=a&&a.__esModule?()=>a.default:()=>a;return e.d(t,{a:t}),t},d:(a,t)=>{for(var s in t)e.o(t,s)&&!e.o(a,s)&&Object.defineProperty(a,s,{enumerable:!0,get:t[s]})},o:(e,a)=>Object.prototype.hasOwnProperty.call(e,a)};(()=>{"use strict";const a=flarum.core.compat["admin/app"];var t=e.n(a);function s(e,a){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,a){return e.__proto__=a,e},s(e,a)}function r(e,a){e.prototype=Object.create(a.prototype),e.prototype.constructor=e,s(e,a)}const n=flarum.core.compat["admin/components/ExtensionPage"];var i=e.n(n);const o=flarum.core.compat["common/components/LoadingIndicator"];var l=e.n(o);const d=flarum.core.compat["common/Component"];var c=e.n(d),u=function(e){function a(){return e.apply(this,arguments)||this}r(a,e);var t=a.prototype;return t.view=function(){var e=this.attrs.stats||{total:0,positive:0,neutral:0,negative:0};return m("div",{className:"TraderFeedbackStats"},this.card({icon:"fas fa-exchange-alt",value:e.total,label:"Total Feedbacks",type:"total"}),this.card({icon:"fas fa-thumbs-up",value:e.positive,label:"Positive",percentage:e.total>0?Math.round(e.positive/e.total*100):0,type:"positive"}),this.card({icon:"fas fa-minus-circle",value:e.neutral,label:"Neutral",percentage:e.total>0?Math.round(e.neutral/e.total*100):0,type:"neutral"}),this.card({icon:"fas fa-thumbs-down",value:e.negative,label:"Negative",percentage:e.total>0?Math.round(e.negative/e.total*100):0,type:"negative"}))},t.card=function(e){return m("div",{className:"StatsCard StatsCard--"+e.type},m("div",{className:"StatsCard-icon"},m("i",{className:e.icon})),m("div",{className:"StatsCard-content"},m("div",{className:"StatsCard-value"},e.value),m("div",{className:"StatsCard-label"},e.label),void 0!==e.percentage&&m("div",{className:"StatsCard-percentage"},e.percentage,"%")))},a}(c());const p=flarum.core.compat["common/components/Button"];var f=e.n(p);const b=flarum.core.compat["common/helpers/avatar"];var h=e.n(b);const v=flarum.core.compat["common/helpers/humanTime"];var g=e.n(v),y=function(e){function a(){return e.apply(this,arguments)||this}return r(a,e),a.prototype.view=function(){var e,a,s,r,n=this.attrs,i=n.feedback,o=n.included,l=n.onApprove,d=n.onReject,c=(null==(e=i.relationships)||null==(e=e.fromUser)||null==(e=e.data)?void 0:e.id)||(null==(a=i.relationships)||null==(a=a.from)||null==(a=a.data)?void 0:a.id),u=(null==(s=i.relationships)||null==(s=s.toUser)||null==(s=s.data)?void 0:s.id)||(null==(r=i.relationships)||null==(r=r.to)||null==(r=r.data)?void 0:r.id),p=c?t().store.getById("users",c):null,b=u?t().store.getById("users",u):null;if(!p&&c){var v=null==o?void 0:o.find((function(e){return"users"===e.type&&e.id===c}));v&&(p=t().store.pushPayload({data:v}))}if(!b&&u){var y=null==o?void 0:o.find((function(e){return"users"===e.type&&e.id===u}));y&&(b=t().store.pushPayload({data:y}))}var k="positive"===i.attributes.type?"success":"negative"===i.attributes.type?"danger":"warning",N="positive"===i.attributes.type?"thumbs-up":"negative"===i.attributes.type?"thumbs-down":"minus";return m("div",{className:"FeedbackCard FeedbackCard--"+i.attributes.type},m("div",{className:"FeedbackCard-header"},m("div",{className:"FeedbackCard-users"},m("div",{className:"FeedbackCard-user"},p&&h()(p),m("div",{className:"FeedbackCard-userInfo"},m("span",{className:"FeedbackCard-label"},"From:"),m("strong",null,p?p.displayName():"User #"+c))),m("i",{className:"fas fa-arrow-right FeedbackCard-arrow"}),m("div",{className:"FeedbackCard-user"},b&&h()(b),m("div",{className:"FeedbackCard-userInfo"},m("span",{className:"FeedbackCard-label"},"To:"),m("strong",null,b?b.displayName():"User #"+u)))),m("div",{className:"FeedbackCard-meta"},m("span",{className:"FeedbackCard-type Badge Badge--"+k},m("i",{className:"fas fa-"+N}),i.attributes.type),m("span",{className:"FeedbackCard-date"},g()(new Date(i.attributes.created_at))))),m("div",{className:"FeedbackCard-body"},m("div",{className:"FeedbackCard-details"},m("div",{className:"FeedbackCard-detail"},m("span",{className:"FeedbackCard-detailLabel"},"Role:"),m("span",{className:"FeedbackCard-detailValue"},m("i",{className:"fas fa-user"}),i.attributes.role)),i.attributes.discussion_id&&m("div",{className:"FeedbackCard-detail"},m("span",{className:"FeedbackCard-detailLabel"},"Discussion:"),m("span",{className:"FeedbackCard-detailValue"},m("i",{className:"fas fa-comments"}),"#",i.attributes.discussion_id))),i.attributes.comment&&m("div",{className:"FeedbackCard-comment"},m("i",{className:"fas fa-quote-left"}),m("p",null,i.attributes.comment))),m("div",{className:"FeedbackCard-actions"},m(f(),{className:"Button Button--primary",icon:"fas fa-check",onclick:function(){return l(i)}},"Approve"),m(f(),{className:"Button Button--danger",icon:"fas fa-times",onclick:function(){return d(i)}},"Reject")))},a}(c()),k=function(e){function a(){return e.apply(this,arguments)||this}return r(a,e),a.prototype.view=function(){var e,a,s,r,n,i,o,l=this.attrs,d=l.report,c=l.included,u=l.onDismiss,p=l.onDelete,b=(null==(e=d.relationships)||null==(e=e.reporter)||null==(e=e.data)?void 0:e.id)||(null==(a=d.relationships)||null==(a=a.user)||null==(a=a.data)?void 0:a.id),v=b?t().store.getById("users",b):null;if(!v&&b){var y=null==c?void 0:c.find((function(e){return"users"===e.type&&e.id===b}));y&&(v=t().store.pushPayload({data:y}))}var k=null==(s=d.relationships)||null==(s=s.feedback)||null==(s=s.data)?void 0:s.id,N=null==c?void 0:c.find((function(e){return"trader-feedbacks"===e.type&&e.id===k})),F=(null==N||null==(r=N.relationships)||null==(r=r.fromUser)||null==(r=r.data)?void 0:r.id)||(null==N||null==(n=N.relationships)||null==(n=n.from)||null==(n=n.data)?void 0:n.id),C=(null==N||null==(i=N.relationships)||null==(i=i.toUser)||null==(i=i.data)?void 0:i.id)||(null==N||null==(o=N.relationships)||null==(o=o.to)||null==(o=o.data)?void 0:o.id),S=F?t().store.getById("users",F):null,R=C?t().store.getById("users",C):null;if(!S&&F){var _=null==c?void 0:c.find((function(e){return"users"===e.type&&e.id===F}));_&&(S=t().store.pushPayload({data:_}))}if(!R&&C){var w=null==c?void 0:c.find((function(e){return"users"===e.type&&e.id===C}));w&&(R=t().store.pushPayload({data:w}))}var T="positive"===(null==N?void 0:N.attributes.type)?"success":"negative"===(null==N?void 0:N.attributes.type)?"danger":"warning";return m("div",{className:"ReportCard"},m("div",{className:"ReportCard-header"},m("div",{className:"ReportCard-reporter"},v&&h()(v,{className:"Avatar--small"}),m("div",{className:"ReportCard-reporterInfo"},m("span",{className:"ReportCard-label"},"Reported by:"),m("strong",null,v?v.displayName():b?"User #"+b:"Unknown"),d.attributes.created_at&&m("span",{className:"ReportCard-date"},g()(new Date(d.attributes.created_at))))),m("span",{className:"Badge Badge--danger"},m("i",{className:"fas fa-flag"}),"Report")),d.attributes.reason&&m("div",{className:"ReportCard-reason"},m("strong",null,"Reason:"),m("p",null,d.attributes.reason)),N&&m("div",{className:"ReportCard-feedback"},m("div",{className:"ReportCard-feedbackHeader"},m("span",null,"Reported Feedback:"),m("span",{className:"Badge Badge--"+T},N.attributes.type)),m("div",{className:"ReportCard-feedbackUsers"},m("div",{className:"ReportCard-user"},S&&h()(S,{className:"Avatar--small"}),m("span",null,S?S.displayName():"User #"+F)),m("i",{className:"fas fa-arrow-right"}),m("div",{className:"ReportCard-user"},R&&h()(R,{className:"Avatar--small"}),m("span",null,R?R.displayName():"User #"+C))),N.attributes.comment&&m("div",{className:"ReportCard-feedbackComment"},m("i",{className:"fas fa-quote-left"}),m("p",null,N.attributes.comment))),m("div",{className:"ReportCard-actions"},m(f(),{className:"Button Button--primary",icon:"fas fa-check",onclick:function(){return u(d)}},"Dismiss Report"),m(f(),{className:"Button Button--danger",icon:"fas fa-trash",onclick:function(){return p(d)}},"Delete Feedback")))},a}(c()),N=function(e){function a(){return e.apply(this,arguments)||this}return r(a,e),a.prototype.view=function(){var e=this.attrs,a=e.buildSettingComponent,s=e.submitButton;return m("div",{className:"TraderFeedbackSettings"},m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-cog"}),"General Settings"),m("div",{className:"SettingsSection-content"},m("div",{className:"Form-group"},a({type:"boolean",setting:"huseyinfiliz.traderfeedback.requireApproval",label:t().translator.trans("huseyinfiliz-traderfeedback.admin.settings.require_approval_label")})),m("div",{className:"Form-group"},a({type:"boolean",setting:"huseyinfiliz.traderfeedback.allowNegative",label:t().translator.trans("huseyinfiliz-traderfeedback.admin.settings.allow_negative_label")})))),m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-comments"}),"Discussion Settings"),m("div",{className:"SettingsSection-content"},m("div",{className:"Form-group"},a({type:"boolean",setting:"huseyinfiliz.traderfeedback.requireDiscussion",label:t().translator.trans("huseyinfiliz-traderfeedback.admin.settings.require_discussion_label"),help:t().translator.trans("huseyinfiliz-traderfeedback.admin.settings.require_discussion_help")})),m("div",{className:"Form-group"},a({type:"boolean",setting:"huseyinfiliz.traderfeedback.onePerDiscussion",label:t().translator.trans("huseyinfiliz-traderfeedback.admin.settings.one_per_discussion_label"),help:t().translator.trans("huseyinfiliz-traderfeedback.admin.settings.one_per_discussion_help")})))),m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-comment-dots"}),"Comment Settings"),m("div",{className:"SettingsSection-content"},m("div",{className:"Form-group"},a({type:"number",setting:"huseyinfiliz.traderfeedback.minLength",label:t().translator.trans("huseyinfiliz-traderfeedback.admin.settings.min_length_label"),placeholder:"10",min:1})),m("div",{className:"Form-group"},a({type:"number",setting:"huseyinfiliz.traderfeedback.maxLength",label:t().translator.trans("huseyinfiliz-traderfeedback.admin.settings.max_length_label"),placeholder:"1000",min:1})))),m("div",{className:"SettingsSection"},m("h3",null,m("i",{className:"fas fa-user-check"}),"User Requirements"),m("div",{className:"SettingsSection-content"},m("div",{className:"Form-group"},a({type:"number",setting:"huseyinfiliz.traderfeedback.minDays",label:t().translator.trans("huseyinfiliz-traderfeedback.admin.settings.min_days_label"),help:t().translator.trans("huseyinfiliz-traderfeedback.admin.settings.min_days_help"),placeholder:"0",min:0})),m("div",{className:"Form-group"},a({type:"number",setting:"huseyinfiliz.traderfeedback.minPosts",label:t().translator.trans("huseyinfiliz-traderfeedback.admin.settings.min_posts_label"),help:t().translator.trans("huseyinfiliz-traderfeedback.admin.settings.min_posts_help"),placeholder:"0",min:0})))),m("div",{className:"Form-group"},s()))},a}(c()),F=function(e){function a(){for(var a,t=arguments.length,s=new Array(t),r=0;r<t;r++)s[r]=arguments[r];return(a=e.call.apply(e,[this].concat(s))||this).activeTab="settings",a.loading=!1,a.reports=[],a.pendingFeedbacks=[],a.stats=null,a.included=[],a}r(a,e);var s=a.prototype;return s.oninit=function(a){e.prototype.oninit.call(this,a),this.loadStats()},s.content=function(){return m("div",{className:"TraderFeedbackPage"},m(u,{stats:this.stats}),this.tabs(),m("div",{className:"TraderFeedbackPage-content"},this.activeTabContent()))},s.tabs=function(){var e=this;return m("div",{className:"TraderFeedbackTabs"},m("button",{className:"TabButton"+("settings"===this.activeTab?" active":""),onclick:function(){e.activeTab="settings"}},m("i",{className:"fas fa-cog"}),m("span",null,"Settings")),m("button",{className:"TabButton"+("approvals"===this.activeTab?" active":""),onclick:function(){e.activeTab="approvals",0===e.pendingFeedbacks.length&&e.loadPendingFeedbacks()}},m("i",{className:"fas fa-check-circle"}),m("span",null,"Pending Approvals"),this.pendingFeedbacks.length>0&&m("span",{className:"TabButton-badge"},this.pendingFeedbacks.length)),m("button",{className:"TabButton"+("reports"===this.activeTab?" active":""),onclick:function(){e.activeTab="reports",0===e.reports.length&&e.loadReports()}},m("i",{className:"fas fa-flag"}),m("span",null,"Reports"),this.reports.length>0&&m("span",{className:"TabButton-badge TabButton-badge--warning"},this.reports.length)))},s.activeTabContent=function(){var e=this;switch(this.activeTab){case"settings":return m(N,{buildSettingComponent:this.buildSettingComponent.bind(this),submitButton:this.submitButton.bind(this),onSave:function(){return e.saveSettings()}});case"approvals":return this.approvalsContent();case"reports":return this.reportsContent();default:return null}},s.approvalsContent=function(){var e=this;return this.loading?m(l(),null):0===this.pendingFeedbacks.length?m("div",{className:"EmptyState"},m("div",{className:"EmptyState-icon"},m("i",{className:"fas fa-check-circle"})),m("h3",null,"No Pending Approvals"),m("p",null,"All feedbacks have been reviewed")):m("div",{className:"FeedbackList"},this.pendingFeedbacks.map((function(a){return m(y,{key:a.id,feedback:a,included:e.included,onApprove:function(a){return e.approveFeedback(a)},onReject:function(a){return e.rejectFeedback(a)}})})))},s.reportsContent=function(){var e=this;return this.loading?m(l(),null):0===this.reports.length?m("div",{className:"EmptyState"},m("div",{className:"EmptyState-icon"},m("i",{className:"fas fa-shield-alt"})),m("h3",null,"No Active Reports"),m("p",null,"Your community is safe and clean")):m("div",{className:"ReportList"},this.reports.map((function(a){return m(k,{key:a.id,report:a,included:e.included,onDismiss:function(a){return e.dismissReport(a)},onDelete:function(a){return e.deleteReportedFeedback(a)}})})))},s.loadStats=function(){var e=this;t().request({method:"GET",url:t().forum.attribute("apiUrl")+"/trader/stats/summary"}).then((function(a){var t;t=a.data&&Array.isArray(a.data)&&a.data[0]?a.data[0].attributes:a.data&&a.data.attributes?a.data.attributes:a.attributes?a.attributes:void 0!==a.total?a:{total:0,positive:0,neutral:0,negative:0},e.stats={total:t.total||0,positive:t.positive||0,neutral:t.neutral||0,negative:t.negative||0},console.log("✅ Stats loaded:",e.stats),m.redraw()})).catch((function(a){console.error("❌ Stats load error:",a),e.stats={total:0,positive:0,neutral:0,negative:0},m.redraw()}))},s.loadPendingFeedbacks=function(){var e=this;this.loading=!0,this.included=[],m.redraw(),t().request({method:"GET",url:t().forum.attribute("apiUrl")+"/trader/feedback/pending"}).then((function(a){e.pendingFeedbacks=a.data||[],e.included=a.included||[],e.processIncluded(a),e.loading=!1,console.log("✅ Pending feedbacks loaded:",e.pendingFeedbacks.length),m.redraw()})).catch((function(a){console.error("❌ Pending feedbacks error:",a),e.loading=!1,m.redraw()}))},s.loadReports=function(){var e=this;this.loading=!0,this.included=[],m.redraw(),t().request({method:"GET",url:t().forum.attribute("apiUrl")+"/trader/reports"}).then((function(a){e.reports=a.data||[],e.included=a.included||[],e.processIncluded(a),e.loading=!1,console.log("✅ Reports loaded:",e.reports.length),m.redraw()})).catch((function(a){console.error("❌ Reports error:",a),t().alerts.show({type:"error"},"Failed to load reports"),e.loading=!1,m.redraw()}))},s.processIncluded=function(e){e.included&&e.included.forEach((function(e){if("users"===e.type&&e.id&&!t().store.getById("users",e.id)){var a=t().store.createRecord("users");a.pushAttributes(e.attributes||{}),a.id(e.id)}}))},s.approveFeedback=function(e){var a=this;confirm("Approve this feedback?")&&t().request({method:"POST",url:t().forum.attribute("apiUrl")+"/trader/feedback/"+e.id+"/approve"}).then((function(){t().alerts.show({type:"success"},"Feedback approved"),a.loadPendingFeedbacks(),a.loadStats()})).catch((function(e){console.error("Approve error:",e),t().alerts.show({type:"error"},"Failed to approve feedback")}))},s.rejectFeedback=function(e){var a=this;confirm("Reject this feedback?")&&t().request({method:"POST",url:t().forum.attribute("apiUrl")+"/trader/feedback/"+e.id+"/reject"}).then((function(){t().alerts.show({type:"success"},"Feedback rejected"),a.loadPendingFeedbacks(),a.loadStats()})).catch((function(e){console.error("Reject error:",e),t().alerts.show({type:"error"},"Failed to reject feedback")}))},s.dismissReport=function(e){var a=this;confirm("Dismiss this report?")&&t().request({method:"POST",url:t().forum.attribute("apiUrl")+"/trader/reports/"+e.id+"/dismiss"}).then((function(){t().alerts.show({type:"success"},"Report dismissed"),a.loadReports()})).catch((function(e){console.error("Dismiss error:",e),t().alerts.show({type:"error"},"Failed to dismiss report")}))},s.deleteReportedFeedback=function(e){var a=this;confirm("Delete the reported feedback? This action cannot be undone.")&&t().request({method:"POST",url:t().forum.attribute("apiUrl")+"/trader/reports/"+e.id+"/reject"}).then((function(){t().alerts.show({type:"success"},"Feedback deleted"),a.loadReports(),a.loadStats()})).catch((function(e){console.error("Delete error:",e),t().alerts.show({type:"error"},"Failed to delete feedback")}))},s.saveSettings=function(){var e=this;this.loading=!0,this.settings().then((function(){e.loading=!1,t().alerts.show({type:"success"},"Settings saved")})).catch((function(){e.loading=!1,t().alerts.show({type:"error"},"Failed to save settings")}))},a}(i());t().initializers.add("huseyinfiliz-traderfeedback",(function(){t().extensionData.for("huseyinfiliz-traderfeedback").registerPage(F).registerPermission({icon:"fas fa-comment",label:t().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.give_feedback"),permission:"huseyinfiliz-traderfeedback.give"},"reply",!0).registerPermission({icon:"fas fa-flag",label:t().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.report_feedback"),permission:"huseyinfiliz-traderfeedback.report"},"reply",!0).registerPermission({icon:"fas fa-trash",label:t().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.delete_feedback"),permission:"huseyinfiliz-traderfeedback.delete"},"moderate").registerPermission({icon:"fas fa-shield-alt",label:t().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.moderate_feedback"),permission:"huseyinfiliz-traderfeedback.moderate"},"moderate")}))})(),module.exports={}})();
//# sourceMappingURL=admin.js.map