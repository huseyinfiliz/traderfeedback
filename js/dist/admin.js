(()=>{var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};(()=>{"use strict";const t=flarum.core.compat["admin/app"];var a=e.n(t);function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}const n=flarum.core.compat["admin/components/ExtensionPage"];var s=e.n(n);const i=flarum.core.compat["common/components/Button"];var o=e.n(i);const c=flarum.core.compat["common/components/LoadingIndicator"];var d=e.n(c);flarum.core.compat["common/components/Switch"];const l=flarum.core.compat["common/helpers/humanTime"];var p=e.n(l),u=function(e){function t(){return e.apply(this,arguments)||this}var n,s;s=e,(n=t).prototype=Object.create(s.prototype),n.prototype.constructor=n,r(n,s);var i=t.prototype;return i.oninit=function(t){e.prototype.oninit.call(this,t),this.activeTab="settings",this.loading=!1,this.reports=[],this.pendingFeedbacks=[]},i.content=function(){var e=this;return m("div",{className:"TraderFeedbackSettingsPage"},[m("div",{className:"ExtensionPage-header"},m("div",{className:"container"},m("h2","Trader Feedback"))),m("div",{className:"ExtensionPage-tabs"},m("div",{className:"container"},m("nav",{className:"ExtensionPage-tabsNav"},[m("button",{className:"Button"+("settings"===this.activeTab?" Button--primary":""),onclick:function(){e.activeTab="settings",m.redraw()}},[m("i",{className:"fas fa-cog"})," Settings"]),m("button",{className:"Button"+("reports"===this.activeTab?" Button--primary":""),onclick:function(){e.activeTab="reports",0===e.reports.length&&e.loadReports(),m.redraw()}},[m("i",{className:"fas fa-flag"})," Reports ",this.reports.length>0?m("span",{className:"Badge"},this.reports.length):null]),m("button",{className:"Button"+("approvals"===this.activeTab?" Button--primary":""),onclick:function(){e.activeTab="approvals",0===e.pendingFeedbacks.length&&e.loadPendingFeedbacks(),m.redraw()}},[m("i",{className:"fas fa-check-circle"})," Pending Approvals ",this.pendingFeedbacks.length>0?m("span",{className:"Badge"},this.pendingFeedbacks.length):null])]))),m("div",{className:"ExtensionPage-content"},m("div",{className:"container"},this.currentTabContent()))])},i.currentTabContent=function(){switch(this.activeTab){case"settings":return this.settingsContent();case"reports":return this.reportsContent();case"approvals":return this.approvalsContent();default:return null}},i.settingsContent=function(){return m("div",{className:"TraderFeedbackSettings"},[m(".Form",[this.buildSettingComponent({type:"boolean",setting:"huseyinfiliz.traderfeedback.requireApproval",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.require_approval_label")}),this.buildSettingComponent({type:"boolean",setting:"huseyinfiliz.traderfeedback.allowNegative",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.allow_negative_label")}),this.buildSettingComponent({type:"number",setting:"huseyinfiliz.traderfeedback.minLength",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.min_length_label"),min:1}),this.buildSettingComponent({type:"number",setting:"huseyinfiliz.traderfeedback.maxLength",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.settings.max_length_label"),min:1}),this.buildSettingComponent({type:"number",setting:"huseyinfiliz.traderfeedback.minDays",label:"Minimum membership days",help:"Users must be a member for this many days before giving feedback (0 = disabled)",min:0}),this.buildSettingComponent({type:"number",setting:"huseyinfiliz.traderfeedback.minPosts",label:"Minimum posts required",help:"Users must have this many posts before giving feedback (0 = disabled)",min:0}),this.submitButton()])])},i.reportsContent=function(){var e=this;return this.loading?m(d()):0===this.reports.length?m("div",{className:"TraderFeedbackReports-empty"},[m("i",{className:"fas fa-inbox fa-3x"}),m("p",a().translator.trans("huseyinfiliz-traderfeedback.admin.reports.no_reports")),m(o(),{className:"Button Button--primary",onclick:function(){return e.loadReports()}},[m("i",{className:"fas fa-sync"})," Refresh"])]):m("div",{className:"TraderFeedbackReports"},[m("div",{className:"TraderFeedbackReports-header"},m(o(),{className:"Button Button--primary",onclick:function(){return e.loadReports()}},[m("i",{className:"fas fa-sync"})," Refresh"])),this.reports.map((function(t){return e.reportItem(t)}))])},i.approvalsContent=function(){var e=this;return this.loading?m(d()):0===this.pendingFeedbacks.length?m("div",{className:"TraderFeedbackApprovals-empty"},[m("i",{className:"fas fa-check-circle fa-3x"}),m("p",a().translator.trans("huseyinfiliz-traderfeedback.admin.approvals.no_approvals")),m(o(),{className:"Button Button--primary",onclick:function(){return e.loadPendingFeedbacks()}},[m("i",{className:"fas fa-sync"})," Refresh"])]):m("div",{className:"TraderFeedbackApprovals"},[m("div",{className:"TraderFeedbackApprovals-header"},m(o(),{className:"Button Button--primary",onclick:function(){return e.loadPendingFeedbacks()}},[m("i",{className:"fas fa-sync"})," Refresh"])),this.pendingFeedbacks.map((function(t){return e.feedbackItem(t)}))])},i.reportItem=function(e){var t,a,r=this;return m("div",{className:"TraderFeedbackReportItem",key:e.id},[m("div",{className:"TraderFeedbackReportItem-header"},[m("strong","Report #"+e.id),m("span",p()(null==(t=e.attributes)?void 0:t.created_at))]),m("div",{className:"TraderFeedbackReportItem-content"},[m("p",[m("strong","Reason: "),null==(a=e.attributes)?void 0:a.reason])]),m("div",{className:"TraderFeedbackReportItem-actions"},[m(o(),{className:"Button Button--success Button--sm",onclick:function(){return r.dismissReport(e)}},"Dismiss"),m(o(),{className:"Button Button--danger Button--sm",onclick:function(){return r.deleteReportedFeedback(e)}},"Delete Feedback")])])},i.feedbackItem=function(e){var t=this,a=e.attributes||{};return m("div",{className:"TraderFeedbackApprovalItem feedback-"+a.type,key:e.id},[m("div",{className:"TraderFeedbackApprovalItem-header"},[m("span",{className:"feedback-type feedback-type-"+a.type},a.type),m("span",p()(a.created_at))]),m("div",{className:"TraderFeedbackApprovalItem-content"},[m("p",a.comment)]),m("div",{className:"TraderFeedbackApprovalItem-actions"},[m(o(),{className:"Button Button--success Button--sm",onclick:function(){return t.approveFeedback(e)}},"Approve"),m(o(),{className:"Button Button--danger Button--sm",onclick:function(){return t.rejectFeedback(e)}},"Reject")])])},i.loadReports=function(){var e=this;this.loading=!0,m.redraw(),a().request({method:"GET",url:a().forum.attribute("apiUrl")+"/trader/reports"}).then((function(t){e.reports=t.data||[],e.loading=!1,m.redraw()})).catch((function(t){e.loading=!1,a().alerts.show({type:"error"},"Failed to load reports"),m.redraw()}))},i.loadPendingFeedbacks=function(){var e=this;this.loading=!0,m.redraw(),a().request({method:"GET",url:a().forum.attribute("apiUrl")+"/trader/feedback/pending"}).then((function(t){e.pendingFeedbacks=t.data||[],e.loading=!1,m.redraw()})).catch((function(t){e.loading=!1,a().alerts.show({type:"error"},"Failed to load pending feedbacks"),m.redraw()}))},i.dismissReport=function(e){var t=this;confirm("Dismiss this report?")&&a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/trader/reports/"+e.id+"/dismiss"}).then((function(){a().alerts.show({type:"success"},"Report dismissed"),t.loadReports()}))},i.deleteReportedFeedback=function(e){var t=this;confirm("Delete the reported feedback?")&&a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/trader/reports/"+e.id+"/reject"}).then((function(){a().alerts.show({type:"success"},"Feedback deleted"),t.loadReports()}))},i.approveFeedback=function(e){var t=this;confirm("Approve this feedback?")&&a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/trader/feedback/"+e.id+"/approve"}).then((function(){a().alerts.show({type:"success"},"Feedback approved"),t.loadPendingFeedbacks()}))},i.rejectFeedback=function(e){var t=this;confirm("Reject this feedback?")&&a().request({method:"POST",url:a().forum.attribute("apiUrl")+"/trader/feedback/"+e.id+"/reject"}).then((function(){a().alerts.show({type:"success"},"Feedback rejected"),t.loadPendingFeedbacks()}))},t}(s());a().initializers.add("huseyinfiliz-traderfeedback",(function(){a().extensionData.for("huseyinfiliz-traderfeedback").registerPage(u).registerPermission({icon:"fas fa-exchange-alt",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.give_feedback"),permission:"huseyinfiliz-traderfeedback.giveFeedback"},"reply").registerPermission({icon:"fas fa-exchange-alt",label:a().translator.trans("huseyinfiliz-traderfeedback.admin.permissions.moderate_feedback"),permission:"huseyinfiliz-traderfeedback.moderateFeedback"},"moderate")}))})(),module.exports={}})();
//# sourceMappingURL=admin.js.map