{"version":3,"file":"src_forum_components_FeedbackForm_js.js","mappings":"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","sources":["webpack://@huseyinfiliz/traderfeedback/./src/forum/components/FeedbackForm.js"],"sourcesContent":["import Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport Select from 'flarum/common/components/Select';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport app from 'flarum/forum/app';\nimport Stream from 'flarum/common/utils/Stream';\n\nexport default class FeedbackForm extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n    \n    this.user = this.attrs.user;\n    this.loading = false;\n    \n    this.type = Stream('positive');\n    this.role = Stream('buyer');\n    this.comment = Stream('');\n    this.transactionId = Stream('');\n  }\n  \n  className() {\n    return 'FeedbackFormModal Modal--medium';\n  }\n  \n  title() {\n    return app.translator.trans('huseyinfiliz-traderfeedback.forum.form.title', {\n      username: this.user.displayName()\n    });\n  }\n  \n  content() {\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form\">\n          <div className=\"Form-group\">\n            <label>{app.translator.trans('huseyinfiliz-traderfeedback.forum.form.type_label')}</label>\n            <Select\n              value={this.type()}\n              options={{\n                'positive': app.translator.trans('huseyinfiliz-traderfeedback.forum.form.type_positive'),\n                'neutral': app.translator.trans('huseyinfiliz-traderfeedback.forum.form.type_neutral'),\n                'negative': app.translator.trans('huseyinfiliz-traderfeedback.forum.form.type_negative')\n              }}\n              onchange={this.type}\n            />\n          </div>\n          \n          <div className=\"Form-group\">\n            <label>{app.translator.trans('huseyinfiliz-traderfeedback.forum.form.role_label')}</label>\n            <Select\n              value={this.role()}\n              options={{\n                'buyer': app.translator.trans('huseyinfiliz-traderfeedback.forum.form.role_buyer'),\n                'seller': app.translator.trans('huseyinfiliz-traderfeedback.forum.form.role_seller'),\n                'trader': app.translator.trans('huseyinfiliz-traderfeedback.forum.form.role_trader')\n              }}\n              onchange={this.role}\n            />\n          </div>\n          \n          <div className=\"Form-group\">\n            <label>{app.translator.trans('huseyinfiliz-traderfeedback.forum.form.transaction_id_label')}</label>\n            <input \n              className=\"FormControl\" \n              value={this.transactionId()}\n              oninput={m.withAttr('value', this.transactionId)}\n              placeholder={app.translator.trans('huseyinfiliz-traderfeedback.forum.form.transaction_id_placeholder')}\n            />\n          </div>\n          \n          <div className=\"Form-group\">\n            <label>{app.translator.trans('huseyinfiliz-traderfeedback.forum.form.comment_label')}</label>\n            <textarea \n              className=\"FormControl\" \n              value={this.comment()}\n              oninput={m.withAttr('value', this.comment)}\n              placeholder={app.translator.trans('huseyinfiliz-traderfeedback.forum.form.comment_placeholder')}\n              rows=\"5\"\n            />\n          </div>\n          \n          <div className=\"Form-group\">\n            {Button.component({\n              type: 'submit',\n              className: 'Button Button--primary',\n              loading: this.loading,\n              disabled: !this.comment().trim()\n            }, app.translator.trans('huseyinfiliz-traderfeedback.forum.form.submit_button'))}\n          </div>\n        </div>\n      </div>\n    );\n  }\n  \n  onsubmit(e) {\n    e.preventDefault();\n    \n    if (!this.comment().trim()) {\n      return;\n    }\n    \n    const minLength = app.forum.attribute('huseyinfiliz.traderfeedback.minLength') || 10;\n    const maxLength = app.forum.attribute('huseyinfiliz.traderfeedback.maxLength') || 1000;\n    \n    if (this.comment().length < minLength) {\n      app.alerts.show({ type: 'error' }, app.translator.trans('huseyinfiliz-traderfeedback.forum.form.error_too_short', {min: minLength}));\n      return;\n    }\n    \n    if (this.comment().length > maxLength) {\n      app.alerts.show({ type: 'error' }, app.translator.trans('huseyinfiliz-traderfeedback.forum.form.error_too_long', {max: maxLength}));\n      return;\n    }\n    \n    this.loading = true;\n    \n    app.request({\n      method: 'POST',\n      url: app.forum.attribute('apiUrl') + '/trader/feedback',\n      body: {\n        data: {\n          type: 'feedbacks',\n          attributes: {\n            to_user_id: this.user.id(),\n            type: this.type(),\n            role: this.role(),\n            comment: this.comment(),\n            transaction_id: this.transactionId() || null\n          }\n        }\n      }\n    })\n    .then(() => {\n      app.alerts.show({ type: 'success' }, app.translator.trans('huseyinfiliz-traderfeedback.forum.form.success'));\n      this.hide();\n      \n      // SayfayÄ± yenile\n      if (window.location.pathname.includes('/feedbacks')) {\n        window.location.reload();\n      }\n    })\n    .catch(error => {\n      this.loading = false;\n      this.loaded();\n      \n      if (error.response && error.response.errors) {\n        app.alerts.show({ type: 'error' }, error.response.errors[0].detail);\n      } else {\n        app.alerts.show({ type: 'error' }, 'An error occurred while submitting feedback.');\n      }\n    });\n  }\n}"],"names":["Modal","Button","Select","LoadingIndicator","app","Stream","FeedbackForm","_Modal","apply","arguments","_inheritsLoose","_proto","prototype","oninit","vnode","call","user","attrs","loading","type","role","comment","transactionId","className","title","translator","trans","username","displayName","content","m","value","options","onchange","oninput","withAttr","placeholder","rows","component","disabled","trim","onsubmit","e","_this","preventDefault","minLength","forum","attribute","maxLength","length","alerts","show","min","max","request","method","url","body","data","attributes","to_user_id","id","transaction_id","then","hide","window","location","pathname","includes","reload","error","loaded","response","errors","detail","default"],"sourceRoot":""}